# thermal gas in a 3d box with collisions and chemistry
# particles reflect off global box boundaries Frank

seed	    	    12345
dimension   	    3
global              gridcut 1.0e-5 comm/sort yes

boundary	    ss ss ss
#boundary	    rr rr rr


create_box  	    0 4.64E-6 0 4.64E-6 0 4.64E-6
#create_box  	    0 4.641588834E-6 0 4.641588834E-6 0 4.641588834E-6
create_grid 	    3 3 3

balance_grid        rcb part
#echo                both

species		    mutation.species CH4 H H2 CH3 thermofile calmech.thermo
mixture		    cold CH4 vstream 0.0 0.0 0.0 nrho 7.5E23 temp 1000.0 
mixture		    hot H vstream 0.0 0.0 0.0 nrho 7.5E23 temp 3000.0

#global              temp 2000.0
global              fnum 10000
collide		    vss all FULL_VSS_DATABASE.error
collide_modify      vibrate no rotate no
#fix                 vib vibmode

surf_collide hotwall specular
#surf_collide hotwall diffuse 2000 .5
bound_modify xlo xhi ylo yhi zlo zhi collide hotwall 

create_particles    cold n 0 
create_particles    hot n 0 

stats		    100
compute thermal thermal/grid all species temp  
#compute test thermal/grid all air temp press
compute             temp temp

#compute tvib tvib/grid all species
#fix test ave/grid all 1 100 100 c_test[1]

react               tce null.tce
react_modify rboost 1.0
react_modify partial_energy no c_thermal[1]
#react_modify partition yes
react_modify compute_chem_rates yes
react_modify thermo yes
#react_modify tcell yes
react_modify isothermal no
#react_modify partial_energy no c_thermal

#compute             P reduce ave c_test[2]

#compute           10 grid all species nrho temp u v w
#fix               10 ave/grid all 1 100 100 c_10[*]
#fix test ave/grid all 1 100 100 c_test[1]

#compute           lambda lambda/grid f_10[1] f_10[2] CH4 kall
#fix               lambda ave/grid all 1 100 100 c_lambda[1] c_lambda[2]
#compute avgMFP reduce ave c_lambda[1]
#compute avgKN reduce ave c_lambda[2]
#compute Tmin reduce min c_test[1]

stats_style	    step cpu np nbound nattempt ncoll nreact c_temp


#dump 1 grid all 100 tmp.grid id c_test[1] c_test[2]
#dump                2 image all 1000 image.*.ppm type type pdiam 3.0e-6 &
#		    size 512 512 gline yes 0.005

#dump 		    2 particle all 100 mixture.ke type ke erot evib p_vibmode[1] p_vibmode[2] p_vibmode[3] p_vibmode[4] p_vibmode[5] p_vibmode[6] p_vibmode[7] p_vibmode[8]
#dump_modify	    2 pad 4


#timestep 	    1.00E-9
timestep 	    1.00E-9
run 		    10000
